{
  "hash": "fb68b50b9378a37c12de657680fdcf23",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: pdf\n---\n\n\n\n## Raport 2\n\n### Zuzanna Nasiłowska, Maria Nowacka\n\n#### Zadanie 1\n\nRozważmy próbę $(X_1, ... X_{100})$ z rozkładu normalnego $𝒩 (2,\\ 1)$ przekształconego przez transformatę Sinh-arcsinh z $\\nu = 0$. Korzystając z symulacji Monte Carlo wykonaj wykres funkcji mocy w zależności od $𝜏$ na przedziale $(0.5,\\ 2)$ dla wszystkich trzech testów. Czy istnieje test jednostajnie najmocniejszy spośród nich\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(c(\"gamlss.dist\", \"nortest\", \"moments\"))\n\nlibrary(gamlss.dist)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pakiet 'gamlss.dist' został zbudowany w wersji R 4.4.2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(nortest)\nlibrary(moments)\n\nn <- 100 \nmu <- 2\nsigma <- 1\nnu <- 0\ntaus <- seq(0.5, 2, by = 0.1)\nn_sim <- 1000 \n\nsinh_arcsinh <- function(x, tau, nu) {\n  sinh(tau * (asinh(x) + nu))\n}\n\npower_results <- matrix(0, nrow = length(taus), ncol = 3) \n\nfor (i in seq_along(taus)) {\n  tau <- taus[i]\n  rejections <- matrix(0, nrow = n_sim, ncol = 3)\n  \n  for (j in 1:n_sim) {\n    sample <- rnorm(n, mean = mu, sd = sigma)\n    transformed_sample <- sinh_arcsinh(sample, tau = tau, nu = nu)\n    \n    rejections[j, 1] <- ifelse(shapiro.test(transformed_sample)$p.value < 0.05, 1, 0)\n    \n    rejections[j, 2] <- ifelse(ad.test(transformed_sample)$p.value < 0.05, 1, 0)\n    \n    rejections[j, 3] <- ifelse(jarque.test(transformed_sample)$p.value < 0.05, 1, 0)\n  }\n  \n  power_results[i, ] <- colMeans(rejections)\n}\n\nplot(taus, power_results[, 1], type = \"l\", col = \"red\", lwd = 2,\n     xlab = expression(tau), ylab = \"Moc testu\",\n     main = \"Funkcja mocy dla różnych testów\")\nlines(taus, power_results[, 2], col = \"blue\", lwd = 2)\nlines(taus, power_results[, 3], col = \"green\", lwd = 2)\nlegend(\"bottomright\", legend = c(\"Shapiro-Wilk\", \"Anderson-Darling\", \"Jarque-Bera\"),\n       col = c(\"red\", \"blue\", \"green\"), lwd = 2)\n```\n\n::: {.cell-output-display}\n![](raport_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Zadanie 2\n\nMamy próbę $(X_1, ... X_{100})$ z rozkładu normalnego $𝒩 (2, 1)$ przekształconego przez transformatę Sinh-arcsinh z $𝜏 = 1$. Korzystając z symulacji Monte Carlo wykonaj wykres funkcji mocy w zależności od 𝜈 na przedziale $(−2, 2)$ dla wszystkich trzech testów. Czy istnieje test jednostajnie najmocniejszy spośród nich?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntau <- 1\nnus <- seq(-2, 2, by = 0.1)\npower_results <- matrix(0, nrow = length(nus), ncol = 3)\n\nfor (i in seq_along(nus)) {\n  nu <- nus[i]\n  rejections <- matrix(0, nrow = n_sim, ncol = 3)\n  \n  for (j in 1:n_sim) {\n    sample <- rnorm(n, mean = mu, sd = sigma)\n    transformed_sample <- sinh_arcsinh(sample, tau = tau, nu = nu)\n    \n    rejections[j, 1] <- ifelse(shapiro.test(transformed_sample)$p.value < 0.05, 1, 0)\n    \n    rejections[j, 2] <- ifelse(ad.test(transformed_sample)$p.value < 0.05, 1, 0)\n    \n    rejections[j, 3] <- ifelse(jarque.test(transformed_sample)$p.value < 0.05, 1, 0)\n  }\n  \n  power_results[i, ] <- colMeans(rejections)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(nus, power_results[, 1], type = \"l\", col = \"red\", lwd = 2,\n     xlab = expression(nu), ylab = \"Moc testu\",\n     main = \"Funkcja mocy dla różnych testów\")\nlines(nus, power_results[, 2], col = \"blue\", lwd = 2)\nlines(nus, power_results[, 3], col = \"green\", lwd = 2)\nlegend(\"topright\", legend = c(\"Shapiro-Wilk\", \"Anderson-Darling\", \"Jarque-Bera\"),\n       col = c(\"red\", \"blue\", \"green\"), lwd = 2)\n```\n\n::: {.cell-output-display}\n![](raport_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Zadanie 3\n\nMamy próbę $(X_1, ... X_{100})$ taką, że zmienne losowe $𝑌_𝑖 = \\frac{𝑋_𝑖−2}{1}$ są z rozkładu t-Studenta $𝒯 (𝜈)$. Korzystając z symulacji Monte Carlo wykonaj wykres funkcji mocy w zależności od 𝜈 na przedziale $(0.05, 20)$ dla wszystkich trzech testów. Czy istnieje test jednostajnie najmocniejszy spośród nich?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nortest)\nlibrary(tseries)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: pakiet 'tseries' został zbudowany w wersji R 4.4.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n\n\n:::\n\n```{.r .cell-code}\nn <- 100\nmc <- 1000\nalpha <- 0.05\nnus <- seq(0.05, 20, by = 0.05)\n\npower_results <- matrix(0, nrow = length(nus), ncol = 3)\ncolnames(power_results) <- c(\"Shapiro-Wilk\", \"Anderson-Darling\", \"Jarque-Bera\")\n\nfor (i in seq_along(nus)) {\n  nu <- nus[i]\n  rejections <- matrix(0, nrow = mc, ncol = 3)\n  \n  for (j in 1:mc) {\n    Y <- rt(n, df = nu)\n    \n    rejections[j, 1] <- ifelse(shapiro.test(Y)$p.value < alpha, 1, 0)\n    \n    rejections[j, 2] <- ifelse(ad.test(Y)$p.value < alpha, 1, 0)\n    \n    rejections[j, 3] <- ifelse(jarque.bera.test(Y)$p.value < alpha, 1, 0)\n  }\n  \n  power_results[i, ] <- colMeans(rejections)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(nus, power_results[, 1], type = \"l\", col = \"red\", lwd = 2,\n     xlab = expression(nu), ylab = \"Moc testu\",\n     main = \"Funkcja mocy dla różnych testów\")\nlines(nus, power_results[, 2], col = \"blue\", lwd = 2)\nlines(nus, power_results[, 3], col = \"green\", lwd = 2)\nlegend(\"topright\", legend = c(\"Shapiro-Wilk\", \"Anderson-Darling\", \"Jarque-Bera\"),\n       col = c(\"red\", \"blue\", \"green\"), lwd = 2)\n```\n\n::: {.cell-output-display}\n![](raport_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "raport_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}